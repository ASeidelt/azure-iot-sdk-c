<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Azure IoT C SDK: Multiplexing limitations and alternatives</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Azure IoT C SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Multiplexing limitations and alternatives </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Azure IoT C SDK supports multiplexing - the ability to have multiple device identities sharing the same underlying TLS connection. <b>There are many limitations in its support, however. Before using multiplexing you need to carefully understand these.</b></p>
<h1><a class="anchor" id="autotoc_md125"></a>
Prefer IoT Edge or Azure IoT C# Device SDK for multiplexing if possible</h1>
<p>If you are creating a gateway device, <a href="http://aka.ms/iotedge">Azure IoT Edge</a> is highly recommend over using this SDK to multiplex leaf devices. Edge was designed from the ground up for gateway scenarios including full multiplexing support, store and forward of messages, enhanced diagnostics, module support, and more.</p>
<p>If you need multiplexing for a non-gateway scenario, and if your device has the required resources, using the <a href="https://github.com/Azure/azure-iot-sdk-csharp">Azure IoT Device SDK for C#</a> is highly recommended. The C# Device SDK has a more complete feature set for multiplexing support.</p>
<p><em>The rest of this document will discuss the Azure IoT Device SDK for C (this repo's) multiplexing support.</em></p>
<h1><a class="anchor" id="autotoc_md126"></a>
Supported Protocols</h1>
<p>Multiplexing is supported on the AMQP, AMQP over WebSockets, and HTTPS protocols. It is not supported on MQTT or MQTT over WebSockets.</p>
<h1><a class="anchor" id="autotoc_md127"></a>
Limited functionality</h1>
<p>When multiplexing over an AMQP, AMQP over WebSockets, or HTTP connection, the SDK supports:</p><ul>
<li>Sending telemetry (<code>IoTHubDeviceClient_LL_SendEventAsync</code> and <code>IoTHubDeviceClient_SendEventAsync</code>)</li>
<li>Receiving incoming Cloud-to-Device messages (via callbacks set in <code>IoTHubDeviceClient_LL_SetMessageCallback</code> <code>IoTHubDeviceClient_SetMessageCallback</code>)</li>
</ul>
<p>When multiplexing over an AMQP or AMQP over WebSockets connection (but not HTTP), the SDK also supports</p><ul>
<li>Receiving incoming device methods (via callbacks set in <code>IoTHubDeviceClient_LL_SetDeviceMethodCallback</code> and <code>IoTHubDeviceClient_SetDeviceMethodCallback</code>).</li>
</ul>
<p>The SDK does not support any other features, such as receiving device twins, sending device twin updates, or uploading files to Azure Storage. Any additional IoT features added to the SDK will <em>not</em> support multiplexing.</p>
<h1><a class="anchor" id="autotoc_md128"></a>
Device client support only</h1>
<p>Multiplexing only works when using device client handles (<code>IOTHUB_DEVICE_CLIENT_HANDLE</code> and <code>IOTHUB_DEVICE_CLIENT_LL_HANDLE</code>). Modules (<code>IOTHUB_MODULE_CLIENT_HANDLE</code> and <code>IOTHUB_MODULE_CLIENT_LL_HANDLE</code>) are not supported.</p>
<h1><a class="anchor" id="autotoc_md129"></a>
Samples</h1>
<p>Samples demonstrating multiplexing are available in the <a href="../iothub_client/samples/">device client samples folder</a></p><ul>
<li><a href="../iothub_client/samples/iothub_ll_client_shared_sample">Sending telemetry and receiving Cloud-to-Device messages</a></li>
<li><a href="../iothub_client/samples/iothub_client_sample_amqp_shared_methods">Receiving device methods</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
